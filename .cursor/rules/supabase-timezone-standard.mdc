---
description: Supabase 및 데이터베이스 테이블의 시간대(Timezone) 설정 표준 정의 (KST, UTC+9)
globs: docs/sql/*.sql, src/**/*.ts, src/**/*.tsx
alwaysApply: true
---

# 시간대(Timezone) 설정 표준 가이드 (KST, UTC+9)

이 프로젝트는 한국 사용자 경험을 최우선으로 하며, 모든 시간 데이터는 **한국 표준시(KST, UTC+9)**를 기준으로 처리하고 저장하는 것을 원칙으로 합니다.

## 1. 데이터베이스(PostgreSQL/Supabase) 표준

### 1.1 컬럼 타입 정의
- 모든 날짜 및 시간 컬럼은 `timestamp with time zone` (**TIMESTAMPTZ**) 타입을 사용합니다.
- 이유: 시간대 정보를 포함하여 저장하며, 세션 설정에 따라 자동으로 변환되어 일관성을 보장합니다.

### 1.2 기본값(Default) 설정
- `created_at`, `updated_at` 등 기본 시간값 설정 시 하드코딩된 UTC 변환을 금지합니다.
- **❌ 금지**: `DEFAULT timezone('utc'::text, now())`
- **✅ 권장**: `DEFAULT now()` 또는 `DEFAULT current_timestamp`
- 이유: 데이터베이스 레벨에서 `timezone`이 `Asia/Seoul`로 설정되어 있으므로, `now()` 사용 시 자동으로 한국 시간이 적용됩니다.

### 1.3 데이터베이스 설정 마이그레이션
- 모든 DB 셋업 스크립트에는 시간대 설정을 포함해야 합니다.
```sql
ALTER DATABASE postgres SET timezone TO 'Asia/Seoul';
```

## 2. 애플리케이션(TypeScript/React) 표준

### 2.1 날짜 표시
- 서버에서 받은 ISO 8601 문자열은 브라우저의 로컬 시간대를 따르되, 필요한 경우 명시적으로 한국 포맷을 사용합니다.
- `toLocaleDateString('ko-KR')` 또는 프로젝트 내 공용 유틸리티(`safeFormatDate` 등)를 활용합니다.

### 2.2 상대 시간 표시 (Ago)
- 목록성 UI에서는 상대 시간(예: 5분 전)보다 절대 날짜 표시를 선호할 수 있습니다. (사용자 요청에 따름)
- 방문 기록 목록 등 특정 UI에서는 상대 시간 표시를 지양하고 날짜만 표기합니다.

## 3. 요약 체크리스트
- [ ] SQL 테이블 생성 시 `TIMESTAMPTZ`를 사용했는가?
- [ ] `DEFAULT` 값으로 `now()`를 사용했는가? (UTC 강제 변환 제거)
- [ ] 신규 환경 구축 시 `ALTER DATABASE ... SET timezone`을 실행했는가?
- [ ] UI에서 한국인에게 친숙한 날짜 포맷(`YYYY년 MM월 DD일`)을 제공하는가?
